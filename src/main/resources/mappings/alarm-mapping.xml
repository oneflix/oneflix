<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="AlarmDAO">

	<insert id="insertMovieAlarm" parameterType="java.util.HashMap">
		<foreach collection="newAlarmList" item="alarm" open="DECLARE BEGIN" close="; END;" separator=";">
			INSERT INTO alarm (alarm_id, alarm_type, email, send_date, read_check, alarm_count)
			VALUES((SELECT NVL(MAX(alarm_id), 0) + 1 FROM alarm),
			'movie', #{alarm.email}, SYSDATE, 'n', #{alarm.alarmCount})
		</foreach>
	</insert>

	<resultMap type="alarm" id="alarmList">
		<id property="alarmId" column="alarm_id"></id>
		<result property="alarmType" column="alarm_type" />
		<result property="email" column="email" />
		<result property="sendDate" column="send_date" />
		<result property="readCheck" column="read_check" />
	</resultMap>
</mapper>
