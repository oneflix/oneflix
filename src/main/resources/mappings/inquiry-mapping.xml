<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="InquiryDAO">

	<select id="getInquiry" parameterType="inquiry"
		resultType="inquiry">
		SELECT * FROM inquiry WHERE inquiry_id=#{inquiryId}
	</select>

 	<resultMap type="inquiry" id="inquiryList">
		<id property="inquiryId" column="inquiry_id" />
		<result property="inquiryType" column="inquiry_type" />
		<result property="nick" column="nick" />
		<result property="memberEmail" column="member_email" />
		<result property="adminName" column="admin_name" />
		<result property="adminEmail" column="admin_email" />
		<result property="inquiryTitle" column="inquiry_title" />
		<result property="inquiryContent" column="inquiry_content" />
		<result property="emailTitle" column="email_title" />
		<result property="emailContent" column="email_content" />
		<result property="receiveDate" column="receive_date" />
		<result property="replyDate" column="reply_date" />
	</resultMap>

	<select id="getInquiryList" resultMap="inquiryList">
		SELECT * FROM inquiry
		WHERE 1=1
	</select> 

	<insert id="insertInquiry" parameterType="inquiry">
		INSERT INTO inquiry
		(inquiry_id,inquiry_type,nick,member_email,
		inquiry_title,inquiry_content,receive_date)
		VALUES((select
		NVL(max(inquiry_id),0)+1 from inquiry),
		#{inquiryType},#{nick},#{memberEmail},
		#{inquiryTitle},#{inquiryContent},SYSDATE)
	</insert>

	<update id="updateInquiry" parameterType="inquiry">
		UPDATE inquiry
		SET
		email_title=#{emailTitle},email_content=#{emailContent},reply_date=SYSDATE

		WHERE
		inquiry_id=#{inquiryId}
	</update>

	<delete id="deleteInquiry" parameterType="inquiry">
		DELETE FROM inquiry
		WHERE
		inquiry_id=#{inquiryId}
	</delete>

	<!-- 총 게시글 갯수 출력 -->
	<select id="countInquiry" resultType="int">
		SELECT COUNT(*) FROM inquiry
	</select>
	<!-- 페이징 처리 후 게시글 조회 -->
	<select id="selectInquiry" parameterType="paging" resultType="inquiry">
	SELECT * 
		FROM (
			SELECT ROWNUM RNUM, A.* 
				FROM (
						SELECT * 
						FROM INQUIRY 
						ORDER BY INQUIRY_ID DESC 
						) A
				)
	WHERE RNUM BETWEEN #{start} AND #{end}
	</select>
</mapper>
